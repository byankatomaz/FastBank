
--CRIANDO DATA BASE

CREATE DATABASE bytecoin

-- Tabela Cliente
CREATE TABLE Cliente (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    imagem VARCHAR(255),
    nome VARCHAR(100) NOT NULL,
    email VARCHAR(255) UNIQUE NOT NULL,
    cpf VARCHAR(11) NOT NULL,
    tipo VARCHAR(2) CHECK (tipo IN ('PF', 'PJ')),
    salario DECIMAL(10, 2) NOT NULL,
    rua VARCHAR(250) NOT NULL,
    bairro VARCHAR(100) NOT NULL,
    cidade VARCHAR(100) NOT NULL,
    estado VARCHAR(30) NOT NULL,
    num INTEGER,
    cep INTEGER
);

-- Tabela Contato
CREATE TABLE Contato (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    numero VARCHAR(11) NOT NULL,
    cliente_id INTEGER REFERENCES Cliente(id)
);

-- Tabela Conta
CREATE TABLE Conta (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cliente_id INTEGER UNIQUE REFERENCES Cliente(id),
    saldo DECIMAL(10, 2) NOT NULL,
    agencia VARCHAR(4) NOT NULL,
    numero VARCHAR(8) UNIQUE NOT NULL
);

-- Tabela Cartao
CREATE TABLE Cartao (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    numero VARCHAR(16) UNIQUE NOT NULL,
    cvv VARCHAR(3) UNIQUE NOT NULL,
    tipo VARCHAR(10) CHECK (tipo IN ('CD/CC', 'CD')) NOT NULL,
    conta_id INTEGER UNIQUE REFERENCES Conta(id),
    limite DECIMAL(10, 2) NOT NULL,
    vencimento DATE NOT NULL
);

-- Tabela Movimentacao
CREATE TABLE Movimentacao (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    conta_origem_id INTEGER REFERENCES Conta(id),
    conta_destino_id INTEGER REFERENCES Conta(id),
    valor DECIMAL(10, 2) NOT NULL,
    tipo_movimentacao VARCHAR(20) CHECK (tipo_movimentacao IN ('TED', 'DEP', 'PIX', 'PAG')) NOT NULL

);

-- Tabela Extrato
CREATE TABLE Extrato (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    conta_id INTEGER REFERENCES Conta(id)
);

-- Tabela Emprestimo
CREATE TABLE Emprestimo (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    conta_id INTEGER REFERENCES Conta(id),
    permitido BOOLEAN,
    valor_solicitado DECIMAL(10, 2) NOT NULL,
    parcelas INTEGER NOT NULL,
    taxa_juros DECIMAL(10, 2),
    pag_mensal DECIMAL(10, 2),
    total_pagar DECIMAL(10, 2),
    data_solicitacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

-- Tabela AvaliacaoCredito
CREATE TABLE AvaliacaoCredito (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    conta_id INTEGER REFERENCES Conta(id),
    limite DECIMAL(10, 2),
    permissao BOOLEAN,
    data_solicitacao TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);


-- INSERÇÃO DE DADOS

-- Inserção de Clientes
INSERT INTO Cliente (nome, email, cpf, tipo, salario, rua, bairro, cidade, estado, num, cep)
VALUES 
    ('Keven Da Hora', 'dahora@gmail.com', '51462773855', 'PF', 15000, 'Rua Jacarezinho', 'Colina das nascentes', 'Campinas', 'São Paulo', 526, 13025625),
    ('Julia', 'silvaJulinhaa@gmail.com', '58263259845', 'PF', 13000, 'Rua Jose Afonso', 'Bairro das nascentes', 'Sumaré', 'São Paulo', 155, 13125642),
    ('Beck', 'beckLuis@gmail.com', '25632145685', 'PF', 15000, 'Rua Dos Papagaios', 'Arara Azul', 'Campinas', 'São Paulo', 132, 13625495),
    ('Maciel', 'macielJulia@gmail.com', '12546253126', 'PF', 25000, 'Rua dos Coqueiros', 'Parque das Aguas', 'Hortolandia', 'São Paulo', 665, 13256245);


-- Inserção de Contatos
INSERT INTO Contato (numero, cliente_id)
VALUES 
    ('5263112522', 1),
    ('5263112522', 2),
    ('5263112522', 3),
    ('5263112522', 4);
	

-- Inserção de Movimentações
INSERT INTO Movimentacao (conta_origem_id, valor, tipo_movimentacao)
VALUES 
    (1, 10000, 'DEP'),
    (2, 45000, 'DEP'),
    (3, 25000, 'DEP'),
    (4, 12500, 'DEP');

-- Inserção de Movimentações
INSERT INTO Movimentacao (conta_origem_id, conta_destino_id, valor, tipo_movimentacao)
VALUES 
    (1, 4, 100, 'TED'),
    (2, 3, 450, 'TED'),
    (3, 2, 250, 'TED'),
    (4, 1, 125, 'TED');

-- Inserção de Avaliações de Crédito
INSERT INTO AvaliacaoCredito (conta_id, limite, permissao, data_solicitacao)
VALUES 
    (1, 700, true, CURRENT_DATE),
    (2, 750, true, CURRENT_DATE),
    (3, 800, false, CURRENT_DATE),
    (4, 720, false, CURRENT_DATE);

-- Inserção de Empréstimos
INSERT INTO Emprestimo (conta_id, valor_solicitado, parcelas, data_solicitacao)
VALUES 
    (1, 750, 12, CURRENT_DATE),
    (2, 500, 12, CURRENT_DATE),
    (3, 700, 12, CURRENT_DATE),
    (4, 250, 12, CURRENT_DATE);




